### zookeeper使用场景

zookeeper是分布式系统中最常见的一个系统。

大致来说，zookeeper的使用场景如下：

**. 分布式协调

. 分布式锁

. 元数据/配置信息管理

. HA高可用性**


#### 分布式协调

这是zookeeper一个很经典的用法，简单来说，就是A系统发送个请求到mq，然后B系统消费消息后，A系统无法知道B系统的处理结果。这时候，就可以**使用zookeeper实现分布式系统之间的协调工作**。A系统发送请求后可以**在zookeeper上对某个节点的值注册个监听器**，一旦B系统处理完了就修改zookeeper那个节点的值，A系统立马就可以收到通知。

 ![分布式协调](../image/201904110001.jpg)
 
  
#### 分布式锁

对某一个数据连续发出两个修改操作，两台机器同时收到了请求，但是只能一台机器先执行完另外一台机器再执行。那么此时可以使用zookeeper分布式锁，一个机器接收到请求之后先获取zookeeper上的一把分布式锁，就是先去创建一个有序的临时节点znode，接着执行操作；然后另外一个机器也**尝试去创建**那个znode，结果发现自己创建不了，只能等着，等第一个机器执行完了再执行。

 ![分布式锁](../image/201904110002.jpg)
 
 
#### 元数据/配置信息管理

zookeeper可以用作很多系统的配置信息的管理，比如kafka、storm等很多分布式系统都会选用zookeeper来做一些元数据、配置信息的管理，包括dubbo注册中心也支持zookeeper。

 ![元数据/配置信息管理](../image/201904110003.jpg)
 
 
#### HA高可用性

比如hadoop、hdfs、yarn等很多大数据系统，都选择基于zookeeper来开发HA高可用机制，就是**一个重要进程一般会做主备两个**，主进程挂了立马通过zookeeper感知到切换到备用进程。

 ![HA高可用机制](../image/201904110004.jpg)





 




  
  
  
  
  

